---
title: "Introductory Time Series"
subtitle: "Session 4"
author: "Richard M. Smith"
date: "2018/01/25"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```


---
# Class overview

- Homework / Project

- Git

- Differencing & ACF

- Modeling Overview 

  - General Methods & Toolbox Review
  
  - Exponential smoothing

  - ARIMA models

- Quiz

---
# Class 3 Homework

- Final 2 questions from Session 2 in-class test

- Due 2/1 before class

--
# Project

- 20 - 25 minutes presentation

- 5 - 10 muinutes questions

A:  Patrick, Jeff, Treva, Nathan, Derek (Discussant group B)

B:  Ian, Tammy, Paul, Jack, Rachel  (Discussant group C)

C:  Jay, Andrew, Taylor, Adam, Brenden (Discussant group A)

---
# Git Resources

- [Main site & documentation](https://git-scm.com/)

  - [Getting Started - Git Basics](https://git-scm.com/book/en/v2/Getting-Started-Git-Basics)

- [Happy Git and GitHub for the useR](http://happygitwithr.com/)

- [Oh shit, git!](http://ohshitgit.com/)


---
# Basic Commands

- `git init`

- `git status`

- `git add .`

- `git commit`
  - `-m "Commit message"`

- `git reflog`
  - `git reset HEAD@{index}`

---
## Differencing and stationarity

Transformations such as logarithms can help to stabilize the variance of a time series. Differencing can help stabilize the mean of a time series by removing changes in the level of a time series, and therefore eliminating (or reducing) trend and seasonality.

---
## Tests for stationarity

- Unit root tests:  statistical tests of stationarity.

- Designed to determine whether differencing is required.

- *Augmented Dickey-Fuller (ADF) test*

The null-hypotheses for an ADF is that the data are non-stationary (unit root).  Thus, small p-values suggest stationarity. 

- `adf.test` in *tseries* package

---
# Forecasting Strategies

- Leading variables

- Associated variable that is easier to predict

- Generalized new product (e.g. Bass diffusion model)

- Extrapolate past trends with adaptive estimates

---
# Simple

- Average $\hat{y}_{T+h|Y} = \bar{y} = (y_1 + ... + y_T)/T$

- Naive $\hat{y}_{T+h|T} = y_T$

- Seasonal Naive $\hat{y}_{T+h|T} = y_{T+h-km}$

- Drift:  Variation on naive allowing increases / decreases over time
  - The "Drift"" is the average change seen in the historical data

---
# Transformations & Adjustments

- Calendar

- Population

- Inflation

- Power transformations

- Bias Adjustments

---
# Residual Diagnostics

- Residual mean close to zero will provide unbiased forecasts

- Non-normal distribution may lead to inaccurate prediction intervals

- `forecast::checkresiduals`


---
# Judgmental Forecasts

Keys to improved accuracy:

- Important Domain Knowledge

- Timely, up-to-date Information

- [Superforecasting](https://goo.gl/CdJxfV)

---
# Key Principles

1.  Set the forecast task clearly & concisely

2.  Implement a systematic approach

3.  Document and justify

  - Seek critical feedback

4.  Segregate forecasters and users

---
# New Product Forecasting

- Bound the problem

- Bass Model
  
  1.  Total people who buy the product $m$
  
  2.  Coefficient of innovation $p$
  
  3.  Coefficient of imitation $q$

---
# ETS vs. ARIMA

- ETS - (Error, Trend, Seasonal) or ExponenTial Smoothing

- ARIMA - Autoregressive integrated moving average

- While exponential smoothing based on description of the trend and seasonality in the data, ARIMA models aim to describe the autocorrelations


---
# Simple Exponential Smoothing

Forecasts produced using exponential smoothing methods are weighted averages of past observations, with the weights decaying exponentially as the observations get older.

- `forecast::ses`

- Appropriate for forecasting data with no clear trend or seasonal pattern

---
# Trend Methods

- Holt's linear trend

The forecasts generated by Holtâ€™s linear method display a constant trend (increasing or decreasing) indefinitely into the future. Empirical evidence indicates that these methods tend to over-forecast, especially for longer forecast horizons.

---
# Holt-Winters

- Extended trend method to capture seasonality

- Exponentially weighted moving averages to update estimates of the seasonally adjusted mean, slope, and seasonals


---
# `ets` function

- Unlike the `ses`, `holt`, `hw` functions, `ets` does not produce forecasts

- Esimates model parameters and returns information


---
# Regression & Generalized Least Squares

With positive serial correlation in the residual series, implies that standard errors of the estimated regression parameters are likely to be underestimated.  Less accurate for the same sample size (See section 5.3.3).  GLS can be used to provide better estimates of the standard errors of the regression parameters to account for the autocorrelartion in the residual series.

- `gls`

---
# Dygraphs

The dygraphs package is an R interface to the dygraphs JavaScript charting library. It provides rich facilities for charting time-series data in R, including:

- Automatically plots xts time series objects (or any object convertible to xts).
- Highly configurable axis and series display (including optional second Y-axis).
- Rich interactive features including zoom/pan and series/point highlighting.
- Display upper/lower bars (e.g. prediction intervals) around series.
- Various graph overlays including shaded regions, event lines, and point annotations.
- Use at the R console just like conventional R plots (via RStudio Viewer).
- Seamless embedding within R Markdown documents and Shiny web applications

---
# Why

- Level of interaction

  - People come from expectation of some interaction

- Built in functions for lots of standard views

- https://rstudio.github.io/dygraphs/

---
# Example

```{r,echo=FALSE,message=FALSE}
require(dygraphs)
lungDeaths <- cbind(mdeaths, fdeaths) # explain multiple ts?
dygraph(lungDeaths) %>% dyRangeSelector()
```

